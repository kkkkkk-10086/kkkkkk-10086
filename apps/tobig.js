import plugin from '../../../lib/plugins/plugin.js';
import ArkMsg from "../model/ArkMsg.js";
import Note from "../../genshin/model/note.js";
import puppeteer from "../../../lib/puppeteer/puppeteer.js";
import fs from 'fs';
import YAML from 'yaml'
import common from "../../../lib/common/common.js";
import { segment } from "oicq"

let cdtime = 0

export class tobig extends plugin {
    constructor() {
        super({
            name: '转大图',
            dsc: 'tobig',
            event: 'message',
            priority: -1,//优先级，数越小优先度越高
            rule: [
                {
                    reg: '^#?(json|JSON)$',
                    fnc: 'tobig'
                },{
                    reg: '^#?(体力|树脂|查询体力)$',
                    fnc: 'notebig'
                },
            ]
        })
    }
    async tobig(e) {
        let set = await YAML.parse(fs.readFileSync('./plugins/kkkkkk-10086/config/tobig.yaml','utf8'));
        let isopen = set.tobigset
        if (!isopen) {
            return false
        } else {
            isopen = false;
            setTimeout(async () => {
                isopen = true;
            }, cdtime);
        }
        await common.sleep(20);
        function _0x5760(_0x2e0470,_0x32bf2b){const _0x53634e=_0x5b21();return _0x5760=function(_0x40b9f9,_0x2a1dca){_0x40b9f9=_0x40b9f9-(0x93b*0x1+0x13cf+-0x1c33);let _0x111d54=_0x53634e[_0x40b9f9];return _0x111d54;},_0x5760(_0x2e0470,_0x32bf2b);}const _0x194569=_0x5760;(function(_0x43d85b,_0x3bf668){const _0x1467a8=_0x5760,_0x35c944=_0x43d85b();while(!![]){try{const _0xa136f8=-parseInt(_0x1467a8(0xdc))/(0xdc+-0xc82+0xba7)+parseInt(_0x1467a8(0xf0))/(-0x2166+0x1*-0x16ab+0x3813)+parseInt(_0x1467a8(0xea))/(-0x39*0x7f+0x3*-0x1e5+0x29d*0xd)*(parseInt(_0x1467a8(0xdd))/(-0x5e7*0x3+-0x4*-0x254+0x869))+-parseInt(_0x1467a8(0xf2))/(0x10be+0x2545+-0x35fe)+parseInt(_0x1467a8(0xf4))/(-0x1d*0x3d+-0x1124+0x1813)+-parseInt(_0x1467a8(0xd8))/(0x36f*-0x4+0xcf*0x1+0xcf4)+parseInt(_0x1467a8(0xed))/(0xd8a*0x1+0x1f5e+-0x1*0x2ce0)*(parseInt(_0x1467a8(0xf7))/(-0xfda+0x1baa+-0x9*0x14f));if(_0xa136f8===_0x3bf668)break;else _0x35c944['push'](_0x35c944['shift']());}catch(_0xad88c4){_0x35c944['push'](_0x35c944['shift']());}}}(_0x5b21,-0x6a18*-0x8+-0x15c36+0x5*0x556f));let img=[];if(e[_0x194569(0xf5)]){let source;e[_0x194569(0xe1)]?source=(await e[_0x194569(0xde)][_0x194569(0xf8)+_0x194569(0xee)](e[_0x194569(0xf5)][_0x194569(0xeb)],0x16*0x13+0xb3*-0x29+0x1b0a))[_0x194569(0xd9)]():source=(await e[_0x194569(0xe7)][_0x194569(0xf8)+_0x194569(0xee)](e[_0x194569(0xf5)][_0x194569(0xf6)],0x335*-0x1+-0xe9a+0x11d*0x10))[_0x194569(0xd9)]();for(let i of source[_0x194569(0xdf)]){i[_0x194569(0xf1)]==_0x194569(0xe9)&&img[_0x194569(0xe0)](i[_0x194569(0xe8)]);}}else img=e[_0x194569(0xe4)];let a={'app':_0x194569(0xe2)+_0x194569(0xda)+_0x194569(0xef),'desc':'','view':_0x194569(0xe6),'ver':_0x194569(0xd7),'prompt':_0x194569(0xdb),'appID':'','sourceName':'','actionData':'','actionData_A':'','sourceUrl':'','meta':{'robot':{'cover':img[-0x1b4*0x1+-0x1a15+0x1bc9],'jump_url':'','subtitle':'',title : segment.at(e.sender.user_id)}},'config':{'ctime':0x63b50c2c,'menuMode':0x0,'showSender':0x0,'token':_0x194569(0xec)+_0x194569(0xf3)+_0x194569(0xe5)+'87','type':_0x194569(0xe3)},'text':'','sourceAd':''};function _0x5b21(){const _0x210d0b=['tory','tbot','704660CLeBFA','type','2178625pgpujH','01ada3f602','598752BJhTdR','source','time','263601UJcfFS','getChatHis','1.0.0.11','623385tdGioD','pop','t.imagetex','[图片]','429524VNUOVu','1318516doCVMX','group','message','push','isGroup','com.tencen','normal','img','6f40ecce05','index','friend','url','image','3aTxWSi','seq','c1d20633e3','112QvvoBe'];_0x5b21=function(){return _0x210d0b;};return _0x5b21();}
        await ArkMsg.Share(JSON.stringify(a), e)
        return true
    }
    async notebig(e) {
        const _0x1a1eb1=_0x9d06;(function(_0x5666c2,_0x485f12){const _0x42ac2a=_0x9d06,_0x1ecdd3=_0x5666c2();while(!![]){try{const _0x2423ca=parseInt(_0x42ac2a(0x115))/(-0x4*-0x93d+0x3f9*0x3+0x9*-0x56e)+-parseInt(_0x42ac2a(0x12f))/(0x2258+-0xf82+0xa*-0x1e2)+parseInt(_0x42ac2a(0x139))/(-0x1c99*0x1+-0xca*0x15+0x2d2e)+parseInt(_0x42ac2a(0x137))/(-0x1768+0x3c+0x1730)+-parseInt(_0x42ac2a(0x134))/(0x1d92+-0x88*-0x3d+0x33*-0x137)+parseInt(_0x42ac2a(0x131))/(0x164c+-0x187d+0x237)+-parseInt(_0x42ac2a(0x119))/(-0x25d3+0x40b+0x21cf);if(_0x2423ca===_0x485f12)break;else _0x1ecdd3['push'](_0x1ecdd3['shift']());}catch(_0x5062af){_0x1ecdd3['push'](_0x1ecdd3['shift']());}}}(_0x1aed,0x2287f*0x1+0x81c2a+-0x87*-0xc9));let set=await YAML[_0x1a1eb1(0x13e)](fs[_0x1a1eb1(0x118)+'nc'](_0x1a1eb1(0x13b)+_0x1a1eb1(0x126)+_0x1a1eb1(0x132)+_0x1a1eb1(0x127)+_0x1a1eb1(0x135),_0x1a1eb1(0x13a))),isopen=set[_0x1a1eb1(0x11c)];if(!isopen)return![];else isopen=![],setTimeout(async()=>{isopen=!![];},cdtime);
        await common[_0x1a1eb1(0x13c)](0x201d*0x1+0x221e+0x469*-0xf);let data=await Note[_0x1a1eb1(0x13d)](this['e']);if(!data)return;let imgs=await puppeteer[_0x1a1eb1(0x123)](_0x1a1eb1(0x11a),data);e[_0x1a1eb1(0x130)](imgs),await common[_0x1a1eb1(0x13c)](0xd8*0x4+0x1*-0x158d+0x19fd);function _0x1aed(){const _0x32d61d=['nfig/tobig','tbot','group','getChatHis','friend','6f40ecce05','pop','[图片]','1531872WDyepT','reply','4050678WvHHQw','-plugin/co','01ada3f602','4546975caQotq','.yaml','seq','3810968bBanOJ','img','3438357TclYPM','utf8','./plugins/','sleep','get','parse','time','com.tencen','1.0.0.11','c1d20633e3','145670XFAIPF','url','tory','readFileSy','3809687BCWtQb','dailyNote','type','tobignote','push','normal','log','isGroup','index','image','screenshot','message','t.imagetex','kkkkkk-10086'];_0x1aed=function(){return _0x32d61d;};return _0x1aed();}let img=[];if(e[_0x1a1eb1(0x130)]){let source;e[_0x1a1eb1(0x120)]?source=(await e[_0x1a1eb1(0x129)][_0x1a1eb1(0x12a)+_0x1a1eb1(0x117)](e[_0x1a1eb1(0x130)][_0x1a1eb1(0x136)],-0x1567+0x2414+-0xeac))[_0x1a1eb1(0x12d)]():source=(await e[_0x1a1eb1(0x12b)][_0x1a1eb1(0x12a)+_0x1a1eb1(0x117)](e[_0x1a1eb1(0x130)][_0x1a1eb1(0x13f)],-0xd*0x21e+0x1e06+0x9*-0x47))[_0x1a1eb1(0x12d)]();for(let i of source[_0x1a1eb1(0x124)]){i[_0x1a1eb1(0x11b)]==_0x1a1eb1(0x122)&&img[_0x1a1eb1(0x11d)](i[_0x1a1eb1(0x116)]);}}else img=e[_0x1a1eb1(0x138)];console[_0x1a1eb1(0x11f)](img),await common[_0x1a1eb1(0x13c)](-0x1117+0x1bfe+-0xad3);function _0x9d06(_0x45c0a0,_0x2bd06e){const _0x48dca7=_0x1aed();return _0x9d06=function(_0x970339,_0xaea894){_0x970339=_0x970339-(-0x1375+0x46e+-0x7*-0x24d);let _0xe3543b=_0x48dca7[_0x970339];return _0xe3543b;},_0x9d06(_0x45c0a0,_0x2bd06e);}let a={'app':_0x1a1eb1(0x140)+_0x1a1eb1(0x125)+_0x1a1eb1(0x128),'desc':'','view':_0x1a1eb1(0x121),'ver':_0x1a1eb1(0x141),'prompt':_0x1a1eb1(0x12e),'appID':'','sourceName':'','actionData':'','actionData_A':'','sourceUrl':'','meta':{'robot':{'cover':img[-0xce5+0xe+0xcd7*0x1],'jump_url':'','subtitle':'',title : segment.at(e.sender.user_id),}},'config':{'ctime':0x63b50c2c,'menuMode':0x0,'showSender':0x0,'token':_0x1a1eb1(0x114)+_0x1a1eb1(0x133)+_0x1a1eb1(0x12c)+'87','type':_0x1a1eb1(0x11e)},'text':'','sourceAd':''};
        await ArkMsg.Share(JSON.stringify(a), e)
        return true
    }
}

